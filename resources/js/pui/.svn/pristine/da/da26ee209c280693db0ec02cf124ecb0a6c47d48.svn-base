KISSY.add("mod/once",function(b,a){b.Once=b.once=PW.Once=PW.once=PW.mod.Once=function(c){return new a(c);};},{requires:["once/ajax","once/form"]});KISSY.add("once/ajax",function(d){var b=d.IO,a={hint:"正在处理,请稍后...",topLayer:0,url:"",success:function(){},error:function(){}};var c=function(e){this.opts=d.merge(a,e);this.ldt;this.ajaxConfig={};this._init();};d.augment(c,{_init:function(){this.ldt=PW.mod.LoadingTip(this.opts);this._getAjaxConfig();this._sendXhr();},_getAjaxConfig:function(j){var h=this,f=h.ldt,g=h.opts,e=h.ajaxConfig;for(var i in g){if(i!="success"&&i!="error"){e[i]=g[i];}}e.success=function(k){d.timer(function(){f.hide(function(){g.success.call(this,k);});},0.1,1);};e.error=function(k){d.timer(function(){f.hide(function(){g.error.call(this,k);});},0.1,1);};},_sendXhr:function(){var g=this,f=g.ldt,e=g.ajaxConfig;if(!e.url){d.log("配置的url地址无效，请检查","warn","PW/mod/once");return;}f.show();b(g.ajaxConfig);}});return c;},{requires:["mod/loading-tip"]});KISSY.add("once/form",function(d){var f=d.DOM,c=f.get,h=f.query,g=d.all,e=d.Event.delegate,b="data-once-lock";var a=function(){this.forms;this._init();};d.augment(a,{_init:function(){this._resetData();this._addEvtDispatcher();},_addEvtDispatcher:function(){var i=this;e(document,"submit","form["+b+'="lock"]',i._formLockHandler,i);},_resetData:function(){var i=this;f.query("form["+b+'="lock"]').each(function(j){j.autocomplete="off";});},_formLockHandler:function(l){var k=this,i=l.target,j=k._getBtns(i),m;m=f.data(i,"onceLock");if(!m){f.data(i,"onceLock",true);d.each(j,function(n){n.disabled=true;});return true;}else{return false;}},_getBtns:function(k){var j=this,i=[];i=h('input[type="submit"],button[type="submit"]',k);if(i.length<1){i=f.filter("button, input",function(l){d.log(f.attr(l,"type"));if(f.nodeName(l)=="button"&&(!f.attr(l,"type")||f.attr(l,"type")==""||f.attr(l,"type")=="button")){return true;}if(f.nodeName(l)=="input"&&f.attr(l,"type")=="button"){return true;}return false;},k);if(i.length!=1){i=[];}}return i;}});new a();},{requires:["core","sizzle"]});